$(function(){[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map(function(t){return new bootstrap.Tooltip(t)});var t=1,s=$("#tabs").tabs();$("#issueArea").addClass("active"),$("#issueList").empty().html('<div class="set-spinner text-center"><div class="spinner-grow text-primary" role="status"><span class="visually-hidden">Loading...</span></div><div class="spinner-grow text-warning" role="status"><span class="visually-hidden">Loading...</span></div><div class="spinner-grow text-success" role="status"><span class="visually-hidden">Loading...</span></div><div class="spinner-grow text-danger" role="status"><span class="visually-hidden">Loading...</span></div></div>'),$.ajax({method:"POST",url:"/blper/issue",dataType:"JSON",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(t){if("0000"==t.code){var s="";$.each(t.items,function(){s+="<div class='item-list' data-site='"+this.site+"' data-title=\""+this.title+"\" data-link='"+this.link+"'>",s+="<span class='item-skip' title='"+this.title+"'>",s+="<img class='list_log'src='/img/icon/logo-"+this.site+".png'>"+this.title,s+="</span>",s+="<span class='item-date'>"+this.date+"</span>",s+="</div>"}),$("#issueList").empty().append(s)}else $("#issueList").empty().append("<div class='set-top text-muted'>- 검색결과 없음 -</div>")},error:function(t){console.log("Error>"+t)}}),$("#keywordArea").addClass("active"),$("#keywordList").empty().html('<div class="set-spinner text-center"><div class="spinner-grow text-primary" role="status"><span class="visually-hidden">Loading...</span></div><div class="spinner-grow text-warning" role="status"><span class="visually-hidden">Loading...</span></div><div class="spinner-grow text-success" role="status"><span class="visually-hidden">Loading...</span></div><div class="spinner-grow text-danger" role="status"><span class="visually-hidden">Loading...</span></div></div>'),$.ajax({method:"POST",url:"/blper/keyword",dataType:"JSON",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(t){if("0000"==t.code){var s="";$.each(t.items,function(){new Date(this.date),s+="<div class='item-list' data-path='hotkey' data-site='"+this.site+"' data-title=\""+this.title+'">',s+="<span class='item-skip' title='"+this.title+"'>",s+="<img class='list_log'src='/img/icon/logo-"+this.site+".png'>"+this.title,s+="</span>",s+="<span class='item-link float-end px-1' data-link='"+this.link+"'><i class='fas fa-external-link-alt'></i></span>",s+="</div>"}),$("#keywordList").empty().append(s)}else $("#keywordList").empty().append("<div class='set-top text-muted'>- 검색결과 없음 -</div>")},error:function(t){console.log("Error>"+t)}}),$("#kw0").focus(),$(".keywordInput").on("click",function(){this.select()}),$(".keywordInput").on("keypress",function(t){var r=a("kw0");if(13===t.keyCode&&i()){var o=n(r);e("GO",s,o)}}),$("#go").on("click",function(){var t=a("kw0");if(i()){var r=n(t);e("GO",s,r)}}),$("#reset").on("click",function(){location.reload()}),$("#views").on("click",function(){$("#viewsSearchHisModalBody").empty(),$.ajax({method:"POST",url:"/blper/views",dataType:"JSON",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(t){var s="";$.each(t,function(){var t="",e=4*Math.random();switch(Math.floor(e)+1){case 1:t="primary";break;case 2:t="secondary";break;case 3:t="success";break;case 4:t="dark";break;default:t="primary"}s+="<button type='button' class='searchWords btn btn-outline-"+t+" m-1'>"+this.query+"</button>"}),$("#viewsSearchHisModalBody").empty().append(s)},error:function(t){console.log("Error>"+t)}})}),$(document).on("click",".se-module-text",function(t){var s=parseInt($("#copyCnt").text());$("#copyCnt").text(s+1)}),$(document).on("click",".relation-word",function(t){var r=$(this).find(".relation-word-area").text();$("#kw0").val(r);var o=a("kw0");if(i()){var l=n(o);e("ADD",s,l)}}),s.on("click","i.fa-trash",function(){var t=$(this).closest("li").remove().attr("aria-controls");$("#"+t).remove(),s.tabs("refresh")}),$(document).on("click",".item-list",function(t){var r=$(this).data("path"),o=$(this).data("link"),l=$(this).data("title");if("hotkey"==r){$("#kw0").val(l);var d=a("kw0");if(i()){var c=n(d);e("GO",s,c)}}else window.open(o);return!1}),$(document).on("click",".item-link",function(t){var s=$(this).data("link");return window.open(s),!1}),$(document).on("click",".searchWords",function(t){$(".modal").modal("hide"),$("#kw0").val($(this).text());var r=a("kw0");if(i()){var o=n(r);e("GO",s,o)}});var e=function(t=null,s=null,e=null){$("#keyWordGrade").empty().text("-"),$("#monTotalCntPc").empty().text(0),$("#monTotalCntMo").empty().text(0),$("#monCnt_naver_b").empty().text(0),$("#monCnt_naver_c").empty().text(0),$("#monCnt_naver_w").empty().text(0),$("#monCnt_daum_b").empty().text(0),$("#monCnt_daum_c").empty().text(0),$("#monCnt_daum_w").empty().text(0),$("main").animate({scrollTop:0,scrollLeft:0},300),$("#tabs").addClass("active"),$("#wordArea").addClass("active");var a=$("#kw0").val(),i=$("#form").serialize();$.ajax({method:"POST",url:"/blper/find",dataType:"JSON",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:i,success:function(t){var i,n,r,o,l,d,c,p,v,m="<div id='"+e+"' class='set-top text-muted'>- 검색결과 없음 -</div>";if("0000"==t.code){var u="";$.each(t.items,function(s){$.each(t.items[s],function(e){$.each(t.items[s][e],function(){"report"==e?$("#monCnt_"+s+"_"+this.type).empty().text(this.total):(u+="<div class='item-list' data-site='"+s+"' data-title=\""+this.title+"\" data-link='"+this.link+"' style='cursor:pointer'>",u+="<span class='item-skip' title='"+this.title+"'>",u+="<img class='list_log'src='/img/icon/logo-"+s+".png'><i class='fas fa-file-alt "+e+"-color'></i> "+this.title,u+="</span>",this.date&&(u+="<span class='item-date'>"+this.date+"</span>"),u+="</div>")})})});var h="";if($.each(t.word,function(s){$.each(t.word[s],function(t){"report"==t?($("#monTotalCntPc").empty().text(this.monTotalCntPc),$("#monTotalCntMo").empty().text(this.monTotalCntMo)):(h+="<div class='relation-word word-list'><span class='relation-word-area text-word'>",h+="<img class='list_log'src='/img/icon/logo-"+s+".png'>"+this.text,h+="</span>","naver"==s&&(h+="<span class='item-cnt'><div class='cnt-pc'><i class='fas fa-desktop fa-sm float-start'></i>"+this.pcCnt+"</div><div class='cnt-mo'><i class='fas fa-mobile-alt fa-sm float-start'></i>"+this.moCnt+"</div></span>"),h+="</div>")})}),e){$("#"+e).remove(),s.append("<div id='"+e+"' class='tab-form'>"+u+"</div>"),s.tabs("refresh"),$("#wordList").empty().append(h),$("b").css({color:"#fa8ba0"}),$("#keyWordGrade").empty().text(t.grade);var f="text-white";t.grade>0&&t.grade<3?f="text-success":t.grade>2&&t.grade<5?f="text-pramary":t.grade>4&&t.grade<8?f="text-warning":t.grade>7&&(f="text-danger"),$("#keyWordGrade").removeClass(),$("#keyWordGrade").addClass(f),$("#monthlyReport").removeClass("d-none"),i=a,n=$("#keyWordGrade").text(),r=$("#monTotalCntPc").text(),o=$("#monTotalCntMo").text(),l=$("#monCnt_naver_b").text(),d=$("#monCnt_naver_c").text(),c=$("#monCnt_daum_b").text(),p=$("#monCnt_daum_c").text(),v="",v+="<tr>",v+="<th scope='row'>"+i+"</th>",v+="<td>"+r+"<br/>"+o+"</td>",v+="<td>"+l+" <br/>"+c+"</td>",v+="<td>"+d+" <br/>"+p+"</td>",v+="<td>"+n+"</td>",v+="</tr>",$("#viewsMonthlyHisModalBody tbody").prepend(v)}t.views>0&&$("#views").empty().text(t.views)}else if("9998"==t.code){alert("검색 제한 횟수 초과!");var y=$("#tab-nav > li").first().remove().attr("aria-controls");$("#"+y).remove(),s.tabs("refresh"),$("#tabs").removeClass("active"),$("#wordArea").removeClass("active"),$("#wordList").empty()}else $("#"+e).remove(),s.append(m),s.tabs("refresh");h||$("#wordList").empty().append(m)},error:function(t){console.log("Error>"+t)}})};function a(t){var s=null;if((s=$("#"+t).val().replace(/[^ㄱ-ㅎ|ㅏ-ㅣ|가-힣a-z0-9\u318D\u119E\u11A2\u2022\u2025a\u00B7\uFE55\s-,. ]/gi,"")).replace(/ /g,""))return $("#"+t).val(s),s;$("#"+t).focus(),$("#"+t).val("")}function i(){var t=!1;return $("#kw0").val()&&($("#monthlyReport").addClass("d-none"),$("#searchArea").removeClass("d-none"),$("#tab-nav").css({display:"block"}),$("#wordTitle").css({display:"block"}),$("#wordList").empty().html('<div class="set-spinner text-center"><div class="spinner-grow text-primary" role="status"><span class="visually-hidden">Loading...</span></div><div class="spinner-grow text-warning" role="status"><span class="visually-hidden">Loading...</span></div><div class="spinner-grow text-success" role="status"><span class="visually-hidden">Loading...</span></div><div class="spinner-grow text-danger" role="status"><span class="visually-hidden">Loading...</span></div></div>'),t=!0),t}function n(e){var a="tab-content-"+t,i=$("<li><a href='#{href}'># #{word}</a><i class='fas fa-trash fa-sm' style='margin:7px 5px 0 -5px; cursor:pointer;'></i></li>".replace(/#\{href\}/g,"#"+a).replace(/#\{word\}/g,e));return s.find(".ui-tabs-nav").prepend(i),s.append("<div id='"+a+'\' class=\'tab-form\'><div class="set-spinner text-center"><div class="spinner-grow text-primary" role="status"><span class="visually-hidden">Loading...</span></div><div class="spinner-grow text-warning" role="status"><span class="visually-hidden">Loading...</span></div><div class="spinner-grow text-success" role="status"><span class="visually-hidden">Loading...</span></div><div class="spinner-grow text-danger" role="status"><span class="visually-hidden">Loading...</span></div></div></div>'),s.tabs("refresh"),s.tabs({active:0}),t++,a}});
